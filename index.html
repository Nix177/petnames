<!-- insérer code : switcher de langue (naviguer par dossier) -->
<script>
// Langues supportées
const SUPPORTED_LANGS = ["fr","en","de","es","zh","hi","ar","bn"];

// Retourne la racine du projet (ex: "/petnames/")
function projectRoot(){
  const parts = location.pathname.split("/");
  if(parts[parts.length-1] === "") parts.pop();            // enlève segment vide final
  const last = (parts[parts.length-1] || "").toLowerCase();
  if (SUPPORTED_LANGS.includes(last)) parts.pop();           // enlève le code langue s'il est présent
  let root = parts.join("/");
  if(root === "") root = "/";                              // sécurité
  if(!root.endsWith("/")) root += "/";
  return root;                                               // ex: "/petnames/"
}

// Construit l'URL cible pour une langue donnée et conserve quelques paramètres utiles
function buildLangUrl(nextLang){
  if(!SUPPORTED_LANGS.includes(nextLang)) nextLang = "en";  // fallback
  const keepKeys = ["species","age","sex","styles","traits"]; // conserve votre config si présente
  const src = new URLSearchParams(location.search);
  const kept = new URLSearchParams();
  keepKeys.forEach(k=>{ if(src.has(k)) kept.set(k, src.get(k)); });
  const qs = kept.toString();
  return projectRoot() + nextLang + "/" + (qs? ("?"+qs) : "");
}

// Branche automatiquement le <select> langue existant
function setupLangSwitcher(){
  const sel = document.querySelector("#lang, #language, select[name='lang']");
  if(!sel) return;
  sel.addEventListener("change", (e)=>{
    const url = buildLangUrl(String(e.target.value).toLowerCase());
    location.href = url; // on navigue vers le bon dossier, pas de ?lang= dans l'URL
  });
}

document.addEventListener("DOMContentLoaded", setupLangSwitcher);
</script>
<!-- /insérer code -->
